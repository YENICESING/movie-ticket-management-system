{"remainingRequest":"D:\\whisper\\cinema\\CinemaManagerAdminVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\whisper\\cinema\\CinemaManagerAdminVue\\src\\views\\cinema\\CinemaInfo.vue?vue&type=style&index=0&id=1c9d2813&scoped=true&lang=css","dependencies":[{"path":"D:\\whisper\\cinema\\CinemaManagerAdminVue\\src\\views\\cinema\\CinemaInfo.vue","mtime":1741600519284},{"path":"D:\\whisper\\cinema\\CinemaManagerAdminVue\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\whisper\\cinema\\CinemaManagerAdminVue\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\whisper\\cinema\\CinemaManagerAdminVue\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\whisper\\cinema\\CinemaManagerAdminVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\whisper\\cinema\\CinemaManagerAdminVue\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci8qIOiwg+aVtOWNoeeJh+i+uei3neWSjOWchuinkiAqLwouZWwtY2FyZCB7CiAgbWFyZ2luOiAyMHB4OwogIGJvcmRlci1yYWRpdXM6IDEycHg7CiAgYm94LXNoYWRvdzogMCAycHggMTJweCByZ2JhKDAsIDAsIDAsIDAuMSk7Cn0KCi8qIOihqOWNlemhuee7n+S4gOmXtOi3nSAqLwouZWwtZm9ybS1pdGVtIHsKICBtYXJnaW4tYm90dG9tOiAyOHB4Owp9CgovKiDovpPlhaXmoYbmoLflvI/nu5/kuIAgKi8KLmVsLWlucHV0LXNob3csCi5lbC1pbnB1dC1zaG93LXRpbWUgewogIHdpZHRoOiAxMDAlOwp9CgovKiDml7bpl7TpgInmi6nlmajluIPlsYDosIPmlbQgKi8KLmVsLWZvcm0taXRlbV9fY29udGVudCB7CiAgZGlzcGxheTogZmxleDsKICBhbGlnbi1pdGVtczogY2VudGVyOwogIGdhcDogMTBweDsKfQoKLyog5b2x5Y6F5qCH562+5qC35byPICovCi5lbC10YWcgewogIG1hcmdpbjogMCA4cHggOHB4IDA7CiAgcGFkZGluZzogMCAxMnB4OwogIGhlaWdodDogMzJweDsKICBsaW5lLWhlaWdodDogMzBweDsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjBmOWZmOwogIGNvbG9yOiAjNDA5ZWZmOwogIGJvcmRlci1jb2xvcjogI2Q5ZWNmZjsKICBib3JkZXItcmFkaXVzOiA0cHg7Cn0KCi8qIOWbvueJh+S4iuS8oOWMuuWfn+e9keagvOW4g+WxgCAqLwouZWwtdXBsb2FkLWxpc3QgewogIGRpc3BsYXk6IGdyaWQ7CiAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiByZXBlYXQoYXV0by1maWxsLCBtaW5tYXgoMTYwcHgsIDFmcikpOwogIGdhcDogMTVweDsKICBtYXJnaW4tdG9wOiAxMHB4Owp9CgovKiDlm77niYfpooTop4jmoLflvI/osIPmlbQgKi8KLmVsLXVwbG9hZC1saXN0X19pdGVtIHsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDE2MHB4OwogIGJvcmRlci1yYWRpdXM6IDhweDsKICBvdmVyZmxvdzogaGlkZGVuOwogIHRyYW5zaXRpb246IHRyYW5zZm9ybSAwLjJzOwp9CgouZWwtdXBsb2FkLWxpc3RfX2l0ZW06aG92ZXIgewogIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtM3B4KTsKfQoKLyog5pON5L2c5oyJ6ZKu5qC35byP57uf5LiAICovCi5lbC1idXR0b24gewogIGZvbnQtc2l6ZTogMTZweDsKICBwYWRkaW5nOiAxMnB4IDI0cHg7CiAgYm9yZGVyLXJhZGl1czogNnB4Owp9CgovKiDmt7vliqDlvbHljoXovpPlhaXmoYbluIPlsYAgKi8KLmVsLWlucHV0LWhhbGwgewogIHdpZHRoOiAzMDBweDsKICBtYXJnaW4tcmlnaHQ6IDE1cHg7Cn0KCi8qIOWvueivneahhuW6lemDqOaMiemSruWvuem9kCAqLwouZGlhbG9nLWZvb3RlciB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kOwogIGdhcDogMTVweDsKfQoKLyog6Z2i5YyF5bGR5a+86Iiq6LCD5pW0ICovCi5ib2FyZCB7CiAgcGFkZGluZzogMThweCAzMHB4OwogIGJhY2tncm91bmQ6ICNmZmY7CiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlZWU7Cn0KCi8qIOS/ruaUueaMiemSrueJueauiuagt+W8jyAqLwouZWwtYnV0dG9uLS1wcmltYXJ5W3N0eWxlKj0iZm9udC1zaXplOiAyMnB4Il0gewogIGZvbnQtc2l6ZTogMTZweCAhaW1wb3J0YW50OwogIHBhZGRpbmc6IDE1cHggMzBweDsKICBiYWNrZ3JvdW5kOiBsaW5lYXItZ3JhZGllbnQoMTM1ZGVnLCAjNDA5ZWZmLCAjMzM3NWI5KTsKICBib3JkZXI6IG5vbmU7Cn0KCi8qIOaXtumXtOmAieaLqeWZqOWuueWZqOiwg+aVtCAqLwouZWwtdGltZS1waWNrZXIgewogIHdpZHRoOiAxODBweDsKfQoKLyog5Zu+54mH5Yig6Zmk5oyJ6ZKu5qC35byP5aKe5by6ICovCi5lbC11cGxvYWQtbGlzdF9faXRlbS1hY3Rpb25zIHsKICBiYWNrZ3JvdW5kOiByZ2JhKDAsIDAsIDAsIDAuNSk7CgogIHNwYW4gewogICAgY29sb3I6IHdoaXRlOwoKICAgICY6aG92ZXIgewogICAgICBjb2xvcjogIzQwOWVmZjsKICAgIH0KICB9Cn0KCi8qIOWTjeW6lOW8j+iwg+aVtCAqLwpAbWVkaWEgKG1heC13aWR0aDogNzY4cHgpIHsKICAuZWwtZm9ybS1pdGVtX19jb250ZW50IHsKICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDsKICB9CgogIC5lbC1pbnB1dC1oYWxsIHsKICAgIHdpZHRoOiAxMDAlOwogICAgbWFyZ2luLWJvdHRvbTogMTBweDsKICB9CgogIC5lbC10aW1lLXBpY2tlciB7CiAgICB3aWR0aDogMTAwJTsKICB9CgogIC5lbC11cGxvYWQtbGlzdCB7CiAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdCgyLCAxZnIpOwogIH0KfQo="},{"version":3,"sources":["CinemaInfo.vue"],"names":[],"mappings":";AAsSA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"CinemaInfo.vue","sourceRoot":"src/views/cinema","sourcesContent":["/*这段代码实现了影院信息的管理功能，包括信息的获取、修改、影厅类别管理和图片上传删除等操作。通过 axios 与后端进行数据交互，\n使用表单验证确保数据的完整性，并使用对话框和提示信息提供良好的用户体验。*/\n<template>\n  <div>\n    <!--面包屑导航区域-->\n    <div class=\"board\">\n      <el-breadcrumb separator-class=\"el-icon-arrow-right\">\n        <el-breadcrumb-item :to=\"{ path: '/welcome' }\">首页</el-breadcrumb-item>\n        <el-breadcrumb-item>影院管理</el-breadcrumb-item>\n        <el-breadcrumb-item>影院信息管理</el-breadcrumb-item>\n      </el-breadcrumb>\n    </div>\n\n    <!--卡片视图-->\n    <el-card class=\"box-card\">\n      <!--表格显示影院信息-->\n      <el-form :model=\"cinemaInfo\" label-width=\"150px\">\n        <el-form-item label=\"影院名称: \" prop=\"cinemaName\">\n          <el-input class=\"el-input-show\" v-model=\"cinemaInfo.cinemaName\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"影院地址: \" prop=\"cinemaAddress\">\n          <el-input class=\"el-input-show\" v-model=\"cinemaInfo.cinemaAddress\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"影院电话: \" prop=\"cinemaPhone\">\n          <el-input class=\"el-input-show\" v-model=\"cinemaInfo.cinemaPhone\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"营业时间: \" prop=\"cinemaPhone\">\n          <el-input class=\"el-input-show-time\" v-model=\"cinemaInfo.workStartTime\" disabled></el-input>\n          至\n          <el-input class=\"el-input-show-time\" v-model=\"cinemaInfo.workEndTime\" disabled></el-input>\n        </el-form-item>\n        <el-form-item label=\"拥有影厅类型: \" prop=\"hallCategory\">\n          <el-tag v-for=\"hall in halls\" :key=\"hall.id\">{{hall}}</el-tag>\n        </el-form-item>\n        <el-form-item label=\"影院图片: \">\n          <span v-for=\"item in pics\" :key=\"item.id\">\n            <el-popover placement=\"left\" trigger=\"click\" width=\"300\">\n              <img :src=\"item.url\" width=\"200%\"/>\n              <img slot=\"reference\" :src=\"item.url\" :alt=\"item\"\n                   style=\"max-height: 300px;max-width: 300px;padding: 10px\"/>\n            </el-popover>\n          </span>\n        </el-form-item>\n        <el-form-item label=\"\" prop=\"cinemaName\">\n          <el-button type=\"primary\" style=\"font-size: 22px;\" @click=\"showEditDialog\">\n             修改影院信息\n          </el-button>\n        </el-form-item>\n      </el-form>\n    </el-card>\n\n    <!--修改影院对话框-->\n    <el-dialog title=\"修改影院\" :visible.sync=\"editDialogVisible\" width=\"60%\" @close=\"editDialogClosed\">\n      <el-form :model=\"editForm\" :rules=\"editFormRules\" ref=\"editFormRef\" label-width=\"150px\">\n        <el-form-item label=\"影院名称\" prop=\"cinemaName\">\n          <el-input v-model=\"editForm.cinemaName\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"影院地址\" prop=\"cinemaAddress\">\n          <el-input v-model=\"editForm.cinemaAddress\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"影院电话\" prop=\"cinemaPhone\">\n          <el-input v-model=\"editForm.cinemaPhone\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"开始营业时间\" prop=\"workStartTime\">\n          <el-time-picker\n            v-model=\"editForm.workStartTime\"\n            value-format=\"HH:mm\"\n            placeholder=\"选择开始营业时间\">\n          </el-time-picker>\n        </el-form-item>\n        <el-form-item label=\"结束营业时间\" prop=\"workEndTime\">\n          <el-time-picker\n            v-model=\"editForm.workEndTime\"\n            value-format=\"HH:mm\"\n            placeholder=\"选择结束营业时间\">\n          </el-time-picker>\n        </el-form-item>\n        <el-form-item label=\"拥有影厅类型\" prop=\"hallCategoryList\">\n          <el-input class=\"el-input-hall\" placeholder=\"请输入添加影厅类别名称\" v-model=\"inputHall\" clearable></el-input>\n          <el-button type=\"primary\" @click=\"addHallCategory()\" style=\"font-size: 18px;\"><i class=\"iconfont icon-r-add\" style=\"font-size: 24px;\"></i> 添加</el-button>\n        </el-form-item>\n        <el-form-item >\n          <el-tag\n            v-for=\"(item, index) in halls\"\n            :key=\"index\"\n            closable\n            @close=\"deleteHallCategory(index)\">\n            {{item}}\n          </el-tag>\n        </el-form-item>\n\n        <el-form-item label=\"影院图片\">\n          <el-upload action=\"\" list-type=\"picture-card\"\n                     :auto-upload=\"false\"\n                     :file-list=\"pics\"\n                     :on-change=\"handleChange\"\n                     :on-success=\"handleSuccess\"\n                     :on-error=\"handleError\"\n                     ref=\"pictureEditRef\"\n                     :http-request=\"submitFile\">\n            <i slot=\"default\" class=\"el-icon-plus\"></i>\n            <div slot=\"file\" slot-scope=\"{file}\">\n              <img class=\"el-upload-list__item-thumbnail\"\n                   :src=\"file.url\" alt=\"file.name\">\n              <span class=\"el-upload-list__item-actions\">\n                <span class=\"el-upload-list__item-preview\"\n                      @click=\"handlePictureCardPreview(file)\">\n                  <i class=\"el-icon-zoom-in\"></i>\n                </span>\n                <span class=\"el-upload-list__item-delete\"\n                      @click=\"handleRemove(file)\">\n                  <i class=\"el-icon-delete\"></i>\n                </span>\n              </span>\n            </div>\n          </el-upload>\n          <!--放大预览-->\n          <el-dialog :visible.sync=\"dialogVisible\" append-to-body>\n            <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\">\n          </el-dialog>\n        </el-form-item>\n      </el-form>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"cancelEdit\" style=\"font-size: 18px;\">  取 消</el-button>\n        <el-button type=\"primary\" @click=\"editCinemaInfo\" style=\"font-size: 18px;\">  确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n  import global from \"../../assets/css/global.css\"\n  export default {\n    data() {\n      return {\n        //控制对话框的显示与隐藏\n        editDialogVisible: false,\n        editForm: {},\n        cinemaInfo: {},\n        editFormRules: {\n          cinemaName: [\n            { required: true, message: '请输入影院名称', trigger: 'change' }\n          ],\n          cinemaAddress: [\n            { required: true, message: '请输入影院地址', trigger: 'change' }\n          ],\n          cinemaPhone: [\n            { required: true, message: '请输入影院电话', trigger: 'change' }\n          ]\n        },\n        inputHall: '',\n\n        dialogImageUrl: '',\n        dialogVisible: false,\n        hideUpload: false,\n        //添加删除图片 动态绑定图片列表\n        pics: [],\n        //添加删除影厅类别 动态绑定影厅列表\n        halls: [],\n        // 发送给后端的JSON图片数组\n        pictureList: [],\n        picNums: 0,\n        deletePicList: []\n      }\n    },\n    created() {\n      this.getCinemaInfo()\n    },\n    methods: {\n      async getCinemaInfo() {\n        const _this = this\n        await axios.get('sysCinema').then(resp => {\n          _this.cinemaInfo = resp.data.data\n        })\n        _this.pics = []\n        _this.halls = []\n\n        for (const item of JSON.parse(this.cinemaInfo.cinemaPicture)) {\n          let pic = {}\n          pic['name'] = ''\n          pic['url'] = this.global.base + item\n          this.pics.push(pic)\n        }\n        for (const item of JSON.parse(this.cinemaInfo.hallCategoryList)) {\n          this.halls.push(item)\n        }\n      },\n      // 显示修改对话框，回显数据\n      async showEditDialog() {\n        this.editForm = this.cinemaInfo\n        this.editDialogVisible = true\n      },\n      // 监听修改对话框的关闭事件\n      editDialogClosed() {\n        this.$refs.editFormRef.resetFields()\n        this.$refs.pictureEditRef.clearFiles()\n        this.pics = []\n        this.pictureList = []\n        this.halls = []\n        this.getCinemaInfo()\n      },\n      // 取消修改\n      cancelEdit() {\n        this.editDialogVisible = false\n        this.deletePicList.splice(0, this.deletePicList.length)\n      },\n      async editCinemaInfo() {\n        await this.submitFile()\n        this.editForm.cinemaPicture = JSON.stringify(this.pictureList)\n        this.editForm.hallCategoryList = JSON.stringify(this.halls)\n        this.$refs.editFormRef.validate(async valid => {\n          const _this = this\n          if (!valid) return\n          let success = true\n          axios.defaults.headers.put['Content-Type'] = 'application/json'\n          await axios.put('sysCinema/update', JSON.stringify(_this.editForm)).then(resp => {\n            if (resp.data.code !== 200){\n              this.$message.error('修改影院信息失败！')\n              success = false\n            }\n          })\n          if (!success) return\n          this.editDialogVisible = false\n          await this.getCinemaInfo()\n          this.$message.success('修改影院信息成功！')\n          for(let item of this.deletePicList) {\n            await axios.get('/upload/delete?filePath=' + item.substring(item.indexOf('/images')))\n          }\n        })\n      },\n      addHallCategory() {\n        if (this.inputHall === '' || this.inputHall === null) {\n          this.$alert('影厅类别添加失败！原因：所添加的影厅类别不能为空。', '影厅类别添加异常', {\n            confirmButtonText: '我知道了'\n          })\n          return\n        } else if (!this.halls.includes(this.inputHall)) {\n          this.halls.push(this.inputHall)\n        } else {\n          console.log('已存在')\n          this.$alert('影厅类别添加失败！原因：所添加的影厅类别已存在。', '影厅类别添加异常', {\n            confirmButtonText: '我知道了'\n          })\n        }\n        this.inputHall = ''\n      },\n      deleteHallCategory(index) {\n        this.halls.splice(index, 1)\n        console.log(this.halls)\n      },\n      handleRemove(file, fileList) {\n        const filePath = file.url\n        console.log(filePath)\n        const idx = this.pics.findIndex(x => x.url === filePath)\n        if (file.status === 'success') {\n          this.deletePicList.push(file.url)\n        }\n        this.pics.splice(idx, 1)\n      },\n      handlePictureCardPreview(file) {\n        this.dialogImageUrl = file.url\n        this.dialogVisible = true\n      },\n      handleChange(file, filelist){\n        this.pics = filelist.slice(0)\n      },\n      handleSuccess(response){\n        this.pictureList.push(response.data)\n        this.editForm = JSON.stringify(this.pictureList)\n      },\n      handleError(err){\n        console.log(err)\n      },\n      async submitFile() {\n        const _this = this\n        for (let i = 0; i < this.pics.length; i++){\n          let formData = new FormData()\n          if (this.pics[i].status === 'success') {\n            let s = this.pics[i].url\n            this.pictureList.push(s.substring(s.indexOf('/images')))\n            continue\n          }\n          let file = this.pics[i].raw\n          formData.append('file', file)\n          await axios.post('upload/cinema', formData).then(response =>{\n            _this.pictureList.push(response.data.data)\n          })\n        }\n      }\n    }\n  }\n</script>\n\n<style scoped>\n/* 调整卡片边距和圆角 */\n.el-card {\n  margin: 20px;\n  border-radius: 12px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);\n}\n\n/* 表单项统一间距 */\n.el-form-item {\n  margin-bottom: 28px;\n}\n\n/* 输入框样式统一 */\n.el-input-show,\n.el-input-show-time {\n  width: 100%;\n}\n\n/* 时间选择器布局调整 */\n.el-form-item__content {\n  display: flex;\n  align-items: center;\n  gap: 10px;\n}\n\n/* 影厅标签样式 */\n.el-tag {\n  margin: 0 8px 8px 0;\n  padding: 0 12px;\n  height: 32px;\n  line-height: 30px;\n  background-color: #f0f9ff;\n  color: #409eff;\n  border-color: #d9ecff;\n  border-radius: 4px;\n}\n\n/* 图片上传区域网格布局 */\n.el-upload-list {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));\n  gap: 15px;\n  margin-top: 10px;\n}\n\n/* 图片预览样式调整 */\n.el-upload-list__item {\n  width: 100%;\n  height: 160px;\n  border-radius: 8px;\n  overflow: hidden;\n  transition: transform 0.2s;\n}\n\n.el-upload-list__item:hover {\n  transform: translateY(-3px);\n}\n\n/* 操作按钮样式统一 */\n.el-button {\n  font-size: 16px;\n  padding: 12px 24px;\n  border-radius: 6px;\n}\n\n/* 添加影厅输入框布局 */\n.el-input-hall {\n  width: 300px;\n  margin-right: 15px;\n}\n\n/* 对话框底部按钮对齐 */\n.dialog-footer {\n  display: flex;\n  justify-content: flex-end;\n  gap: 15px;\n}\n\n/* 面包屑导航调整 */\n.board {\n  padding: 18px 30px;\n  background: #fff;\n  border-bottom: 1px solid #eee;\n}\n\n/* 修改按钮特殊样式 */\n.el-button--primary[style*=\"font-size: 22px\"] {\n  font-size: 16px !important;\n  padding: 15px 30px;\n  background: linear-gradient(135deg, #409eff, #3375b9);\n  border: none;\n}\n\n/* 时间选择器容器调整 */\n.el-time-picker {\n  width: 180px;\n}\n\n/* 图片删除按钮样式增强 */\n.el-upload-list__item-actions {\n  background: rgba(0, 0, 0, 0.5);\n\n  span {\n    color: white;\n\n    &:hover {\n      color: #409eff;\n    }\n  }\n}\n\n/* 响应式调整 */\n@media (max-width: 768px) {\n  .el-form-item__content {\n    flex-direction: column;\n    align-items: flex-start;\n  }\n\n  .el-input-hall {\n    width: 100%;\n    margin-bottom: 10px;\n  }\n\n  .el-time-picker {\n    width: 100%;\n  }\n\n  .el-upload-list {\n    grid-template-columns: repeat(2, 1fr);\n  }\n}\n</style>\n"]}]}